/*! For license information please see main.js.LICENSE.txt */
(()=>{"use strict";class e{static create(n){return fetch("https://question-app-85d33-default-rtdb.europe-west1.firebasedatabase.app/questions.json",{method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>(n.id=e.name,n))).then(t).then(e.renderList)}static renderList(){const e=n(),t=e.length?e.map(i).join(""):"<div>Вопросов нет</div>";document.querySelector(".list").innerHTML=t}static fetch(e){return e?fetch(`https://question-app-85d33-default-rtdb.europe-west1.firebasedatabase.app/questions.json?auth=${e}`).then((e=>e.json())).then((e=>e&&e.error?`\n                <p class = 'error'>${e.error}</p>\n                `:e?Object.keys(e).map((t=>({...e[t],id:t}))):[])):Promise.resolve("<p class = 'error'>Нет токена</p>")}static listToHTML(e){return e.length?`<ol>${e.map((e=>`<li>${e.text}</li>`)).join("")}</ol`:"<p>Вопросов нет</p>"}}function t(e){const t=n();t.unshift(e),localStorage.setItem("questions",JSON.stringify(t))}function n(){return JSON.parse(localStorage.getItem("questions")||"[]")}function i(e){return`\n    <div>\n    ${new Date(e.date).toLocaleDateString()}\n    ${new Date(e.date).toLocaleTimeString()}\n    </div>\n    <div>\n    ${e.text}\n    </div>\n    `}function r(e){return e.length>=10}function a(e,t){const n=document.createElement("div");n.classList.add("modal"),n.innerHTML=`\n        <h1>${e}</h1>\n        <div class = 'modal-content'>${t}</div>\n    `,mui.overlay("on",n)}(()=>{window.addEventListener("load",e.renderList);const t=document.querySelector("#form"),n=t.querySelector("#input-question"),i=t.querySelector("#submit-btn"),s=document.querySelector("#modal-btn");function o(t){"string"==typeof t?a("Ошибка!",t):a("Список вопросов",e.listToHTML(t))}t.addEventListener("submit",(t=>{if(t.preventDefault(),r(n.value)){const t={text:n.value.trim(),date:(new Date).toJSON()};i.disabled=!0,e.create(t).then((()=>{console.log("question",t),n.value="",n.className="",i.disabled=!1}))}})),n.addEventListener("input",(e=>{i.disabled=!r(n.value)})),s.addEventListener("click",(t=>{a("Авторизация",'\n  <form class="mui-form" id="auth-form">\n  <div class="mui-textfield mui-textfield--float-label">\n    <input type="text" id="email" required>\n    <label for="email">Email</label>\n  </div>\n  <div class="mui-textfield mui-textfield--float-label">\n    <input type="text" id="password" required>\n    <label for="password">Пароль</label>\n  </div>\n  <button\n      type="submit"\n      class="mui-btn mui-btn--raised mui-btn--primary"\n      id="enter-btn"\n      >\n      Войти\n  </button>\n</form>\n  '),document.querySelector("#auth-form").addEventListener("submit",(t=>{t.preventDefault();const n=t.target.querySelector("#enter-btn");var i,r;n.disabled=!0,(i=t.target.querySelector("#email").value,r=t.target.querySelector("#password").value,fetch("https://identitytoolkit.googleapis.com/v1/accounts:signInWithPassword?key=AIzaSyA7kOhOqQ3va8sLgc0r7ukIwBB_I6j4psE",{method:"POST",body:JSON.stringify({email:i,password:r,returnSecureToken:!0}),headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>e.idToken))).then(e.fetch).then(o).then((()=>n.disabled=!1))}))}))})()})();